Prepare dataset
==========Train Params==========
{'model': 'bert', 'ckpt_dir': './checkpoint/toutiao_bert_v1', 'export_dir': './serving/toutiao_bert_v1', 'data_dir': './trainsample/toutiao', 'predict_file': 'toutiao_bert_v1.txt', 'nlp_pretrain_model': 'bert_base', 'nlp_pretrain_dir': 'pretrain/chinese_L-12_H-768_A-12', 'nlp_pretrain_ckpt': 'pretrain/chinese_L-12_H-768_A-12/bert_model.ckpt', 'max_seq_len': 150, 'label_size': 15, 'lr': 1e-05, 'enable_cache': False, 'clear_cache': False, 'epoch_size': 5, 'batch_size': 32, 'early_stop_ratio': 1, 'log_steps': 100, 'save_steps': 1000, 'thresholds': [0.6, 0.7, 0.8, 0.9], 'warmup_ratio': 0.1, 'embedding_dropout': 0.3, 'loss_func': <function ce.<locals>.helper at 0x7f65bd137d08>, 'label2idx': {'news_story': 0, 'news_culture': 1, 'news_entertainment': 2, 'news_sports': 3, 'news_finance': 4, 'news_house': 5, 'news_car': 6, 'news_edu': 7, 'news_tech': 8, 'news_military': 9, 'news_travel': 10, 'news_world': 11, 'stock': 12, 'news_agriculture': 13, 'news_game': 14}, 'idx2label': {0: 'news_story', 1: 'news_culture', 2: 'news_entertainment', 3: 'news_sports', 4: 'news_finance', 5: 'news_house', 6: 'news_car', 7: 'news_edu', 8: 'news_tech', 9: 'news_military', 10: 'news_travel', 11: 'news_world', 12: 'stock', 13: 'news_agriculture', 14: 'news_game'}, 'model_dir': './checkpoint/toutiao_bert_v1', 'sample_size': 244920, 'steps_per_epoch': 7653, 'num_train_steps': 38265}
==========Run Config==========
{'keep_checkpoint_max': 3, 'allow_growth': True, 'pre_process_gpu_fraction': 0.8, 'log_device_placement': True, 'allow_soft_placement': True, 'inter_op_parallel': 2, 'intra_op_parallel': 2, 'use_gpu': True, 'log_steps': 100, 'save_steps': 1000, 'summary_steps': 1000}
==========Training bert ==========
Dumping Prediction at ./trainsample/toutiao/toutiao_bert_v1.txt
==========Evaluation Report==========

                    precision    recall  f1-score   support

        news_story       0.81      0.86      0.83      1255
      news_culture       0.87      0.87      0.87      5697
news_entertainment       0.89      0.90      0.90      7878
       news_sports       0.95      0.93      0.94      7558
      news_finance       0.80      0.80      0.80      5434
        news_house       0.90      0.91      0.90      3492
          news_car       0.92      0.93      0.92      7046
          news_edu       0.89      0.89      0.89      5320
         news_tech       0.86      0.87      0.87      8377
     news_military       0.86      0.87      0.86      4990
       news_travel       0.83      0.83      0.83      4375
        news_world       0.82      0.82      0.82      5293
             stock       0.14      0.03      0.05        72
  news_agriculture       0.87      0.85      0.86      3862
         news_game       0.92      0.91      0.91      5889

          accuracy                           0.88     76538
         macro avg       0.82      0.82      0.82     76538
      weighted avg       0.88      0.88      0.88     76538


Exporting Model for serving_model at ./serving/toutiao_bert_v1
